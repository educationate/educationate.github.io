const A=e;function e(a,b){a=a-0x99;const c=d();let f=c[a];return f;}(function(h,i){const y=e,j=h();while(!![]){try{const k=-parseInt(y(0xa6))/0x1+parseInt(y(0xfb))/0x2+-parseInt(y(0xe0))/0x3*(parseInt(y(0xfc))/0x4)+parseInt(y(0xa8))/0x5*(parseInt(y(0xc7))/0x6)+parseInt(y(0xc9))/0x7+parseInt(y(0x9d))/0x8*(-parseInt(y(0xd3))/0x9)+-parseInt(y(0xb9))/0xa;if(k===i)break;else j['push'](j['shift']());}catch(n){j['push'](j['shift']());}}}(d,0x67400));const b=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const n=j['apply'](i,arguments);return j=null,n;}}:function(){};return h=![],k;};}()),a=b(this,function(){const z=e,h={'DwZxa':function(n,o){return n+o;},'QgMMf':function(n){return n();},'sBKHd':z(0xa1),'lZRQb':z(0xed)};let i;try{const n=Function(h[z(0xdb)](z(0xa3)+z(0xf8),');'));i=h['QgMMf'](n);}catch(o){i=window;}const j=i[z(0xf7)]=i['console']||{},k=[h['sBKHd'],'warn','info','error',h['lZRQb'],'table',z(0xe4)];for(let q=0x0;q<k[z(0x9b)];q++){const r=b[z(0xd1)]['prototype'][z(0xcf)](b),s=k[q],t=j[s]||r;r[z(0xa5)]=b[z(0xcf)](b),r[z(0xc4)]=t[z(0xc4)][z(0xcf)](t),j[s]=r;}});a();function d(){const a0=['json','RHQfK','error','image/webp','1039047DXKucT','dir','onupgradeneeded','audio/mp4','trace','font/otf','getAllGms','saveGm','objectStoreNames','delete','files','csv','application/vnd.ms-fontobject','exception','EJISi','application/xml','CHixe','image/jpeg','find','/loadersw.js','cleanupOld','state','BPoJq','console','{}.constructor(\x22return\x20this\x22)(\x20)','application/javascript','isBinary','1502836JYgRVk','4GIqySi','image/x-icon','ahJhq','onsuccess','openCursor','html','continue','image/bmp','length','objectStore','3600tzanVR','video/mp4','put','contains','log','target','return\x20(function()\x20','lastPlayed','__proto__','786557omYFmz','getRegistrations','355RrUVTa','entries','font/woff','serviceWorker','XYcQt','ERjUg','extractMultipleZips','yJZHn','audio/aac','audio/mpeg','split','pop','load','onerror','initDB','updateLastPlayed','has','244330NIbiIZ','text/html','video/ogg','assign','async','iVtLX','ZUqfy','text/plain','regSW','text/css','toISOString','toString','image/svg+xml','Ackrv','60918wWaGxw','result','4734240tTCFfS','readwrite','font/woff2','gm\x20loader\x20db','gm-','waiting','bind','application/octet-stream','constructor','/game/','11367JYswya','activated','font/ttf','installing','FXDFX','readonly','replace','scriptURL','DwZxa'];d=function(){return a0;};return d();}import{af as f}from'./vendor-modules.OeOfergd.js';const p=A(0xcc),m=0x1,c='gms',g=new Set([A(0x101),'htm','css','js','mjs',A(0xdc),'xml','txt','md',A(0xeb),'svg']);class w{constructor(){this['db']=null;}async[A(0xb6)](){return this['db']?this['db']:new Promise((h,i)=>{const B=e,j=indexedDB['open'](p,m);j[B(0xb5)]=()=>i(j['error']),j[B(0xff)]=()=>{const C=B;this['db']=j[C(0xc8)],h(this['db']);},j[B(0xe2)]=k=>{const D=B,n=k['target'][D(0xc8)];n[D(0xe8)][D(0xa0)](c)||n['createObjectStore'](c,{'keyPath':'id'});};});}async['dbAction'](h,i){const E=A,j=await this[E(0xb6)]();return new Promise((k,n)=>{const F=E,q=j['transaction']([c],h)[F(0x9c)](c);i(q,k,n);});}async['saveGm'](h,i){const G=A;return this['dbAction'](G(0xca),(j,k,n)=>{const H=G,o=j[H(0x9f)]({'id':h,'name':h,'files':i,'uploadDate':new Date()['toISOString'](),'lastPlayed':new Date()[H(0xc3)]()});o['onsuccess']=()=>k(),o[H(0xb5)]=()=>n(o[H(0xde)]);});}async['updateLastPlayed'](h){const I=A,i={'CHixe':function(j){return j();}};return this['dbAction'](I(0xca),(j,k,n)=>{const J=I,o=j['get'](h);o[J(0xff)]=()=>{const K=J,q=o[K(0xc8)];if(q){q[K(0xa4)]=new Date()['toISOString']();const u=j['put'](q);u['onsuccess']=()=>k(),u[K(0xb5)]=()=>n(u[K(0xde)]);}else i[K(0xf0)](k);},o[J(0xb5)]=()=>n(o[J(0xde)]);});}async[A(0xf4)](){const L=A,h={'XYcQt':function(i,j){return i-j;},'Ackrv':function(i,j){return i*j;}};return this['dbAction'](L(0xca),(j,k,n)=>{const M=L,o=j[M(0x100)](),q=h[M(0xac)](Date['now'](),h[M(0xc6)](0x10e0,0x3c)*0x3e8);o[M(0xff)]=u=>{const N=M,v=u[N(0xa2)][N(0xc8)];if(v){const x=v['value'];new Date(x['lastPlayed']||x['uploadDate'])['getTime']()<q&&v[N(0xe9)](),v[N(0x99)]();}else k();},o['onerror']=()=>n(o['error']);});}async['getGm'](h){const O=A;return this['dbAction'](O(0xd8),(j,k,n)=>{const P=O,o=j['get'](h);o[P(0xff)]=()=>k(o['result']),o['onerror']=()=>n(o[P(0xde)]);});}async[A(0xe6)](){const Q=A,h={'iVtLX':'readonly'};return this['dbAction'](h[Q(0xbe)],(j,k,n)=>{const R=Q,o=j['getAll']();o[R(0xff)]=()=>k(o[R(0xc8)]||[]),o[R(0xb5)]=()=>n(o['error']);});}['isBinary'](h){const S=A,i=h[S(0xb2)]('.')[S(0xb3)]()['toLowerCase']();return!g[S(0xb8)](i);}async['extractZip'](h){const T=A,j={'YsCTp':'base64','IvrOE':'string'},k=await(await fetch(h))['blob'](),q=await new f()['loadAsync'](k),t={};for(const [u,v]of Object[T(0xa9)](q[T(0xea)]))if(!v[T(0xe1)]){const x=this[T(0xfa)](u);t[u]={'content':await v[T(0xbd)](x?j['YsCTp']:j['IvrOE']),'mime':this['getMime'](u),'binary':x};}return t;}async[A(0xae)](h){const U=A,j={};for(const k of h){const n=await this['extractZip'](k);Object[U(0xbc)](j,n);}return j;}['getMime'](h){const V=A,i={'BPoJq':V(0xf9),'ERjUg':'application/json','xKxew':V(0xc5),'yusfz':V(0xd5),'EJISi':'audio/wav','dpoJc':'audio/ogg','FXDFX':V(0xb0),'yJZHn':V(0xbb),'ZXnPw':'application/wasm','ZUqfy':'application/gzip','RHQfK':'application/octet-stream'},j=h[V(0xb2)]('.')[V(0xb3)]()['toLowerCase']();return{'html':V(0xba),'htm':V(0xba),'css':V(0xc2),'js':i[V(0xf6)],'mjs':i[V(0xf6)],'json':i[V(0xad)],'xml':V(0xef),'txt':V(0xc0),'md':'text/markdown','csv':'text/csv','png':'image/png','jpg':'image/jpeg','jpeg':V(0xf1),'gif':'image/gif','svg':i['xKxew'],'ico':V(0xfd),'webp':V(0xdf),'bmp':V(0x9a),'avif':'image/avif','woff':V(0xaa),'woff2':V(0xcb),'ttf':i['yusfz'],'otf':V(0xe5),'eot':V(0xec),'mp3':V(0xb1),'wav':i[V(0xee)],'ogg':i['dpoJc'],'m4a':V(0xe3),'aac':i[V(0xd7)],'mp4':V(0x9e),'webm':'video/webm','ogv':i[V(0xaf)],'wasm':i['ZXnPw'],'zip':'application/zip','gz':i[V(0xbf)],'pdf':'application/pdf','data':V(0xd0),'unityweb':'application/octet-stream','bundle':V(0xd0),'bin':i[V(0xdd)],'dat':'application/octet-stream','mem':V(0xd0),'asset':V(0xd0),'resource':'application/octet-stream'}[j]||V(0xd0);}async[A(0xc1)](){const W=A,h={'naVay':'statechange'};if(W(0xab)in navigator)try{let i=(await navigator['serviceWorker'][W(0xa7)]())[W(0xf2)](j=>j['active']?.[W(0xda)]['includes'](W(0xf3)));if(!i){const j=await navigator['serviceWorker']['register']('/loadersw.js');return await navigator['serviceWorker']['ready'],j;}return(i[W(0xd6)]||i[W(0xce)])&&await new Promise(k=>{const X=W,n={'veBWw':function(q,r){return q===r;},'ahJhq':function(q){return q();}},o=i[X(0xd6)]||i[X(0xce)];o['addEventListener'](h['naVay'],()=>{const Y=X;n['veBWw'](o[Y(0xf5)],Y(0xd4))&&n[Y(0xfe)](k);});}),i;}catch(k){console[W(0xde)]('from\x20local\x20gm\x20loader',k);}}async[A(0xb4)](h,i){const Z=A,j={'qOfHY':function(r,u){return r+u;},'jiVqV':Z(0xcd),'XEnqn':function(r,u){return r(u);}};await this['regSW'](),await this['initDB']();const k=Array['isArray'](h),n=(k?h[0x0]:h)['split']('/')[Z(0xb3)]()[Z(0xd9)]('.zip','')||j['qOfHY'](j['jiVqV'],Date['now']());if(await this['getGm'](n))return await this[Z(0xb7)](n),{'url':'/game/'+n+'/index.html','cached':!0x0};i&&j['XEnqn'](i,!0x0);const q=k?await this['extractMultipleZips'](h):await this['extractZip'](h);return await this[Z(0xe7)](n,q),i&&i(!0x1),{'url':Z(0xd2)+n+'/index.html','cached':!0x1};}}export{w as default};